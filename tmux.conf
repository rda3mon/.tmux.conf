######################## general ########################
# Set Ctrl+a as prefix key
set -g prefix2 C-a
bind C-a send-prefix -2

# Set base index starting from 1
set -g base-index 1

# Set pane index starting from 1
setw -g pane-base-index 1

# Rename window to currently running program
setw -g automatic-rename on

# When a window is closed, renumber other windows to be continuous
set -g renumber-windows on

# Split window, new window with same directory path
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# Colors
set -g default-terminal "screen-256color"

# Tmux will generate xterm style function key sequences
setw -g xterm-keys on

# Set the escape time in millis, faster response
set -s escape-time 10

# Focus events
set -s focus-events on

# History limit
set -g history-limit 100000

# History file
set -g history-file ~/.tmux_history

# Set program name to windos name
setw -g automatic-rename on

# Rename windows number when one of the window is closed
set -g renumber-windows on

# Terminal title
set -g set-titles on
set -g set-titles-string '❐ #S ● #I #(ps --no-headers -t #{pane_tty} -o args -O-c)'

# Pane indicator display time
set -g display-panes-time 2000

# Status message display time
set -g display-time 2000

# Redraw status line every 10s
set -g status-interval 1

# Activity
set -g monitor-activity on
set -g visual-activity off

# Reload config bind
bind r source-file ~/.tmux.conf \; display '~/.tmux.conf sourced'

setw -g automatic-rename on
set -g set-titles on

# Vi style command mode
set -g status-keys vi

# Vi style copy mode
setw -g mode-keys vi

setw -g mouse on

setw -g window-status-separator ''

setw -g aggressive-resize on

######################## Clipboard ########################
set -s set-clipboard off
bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -se c -i"

######################## Status Bar ########################
# position
set -g status-position bottom

# colors
set-option -g status-bg colour240
set-option -g status-fg colour203
set -g status-attr default

# Right status
set -g status-right '#[fg=colour232,bg=colour208,bold] #(#{mem_percentage}) '
#set -g status-right '#[fg=colour232,bg=colour208,bold] MEM:#(echo $(get_memory_usage))'
#set -g status-right " #[fg=colour232,bg=colour208,bold] MEM: #(echo 'scale=3;' '100-' $(cat /proc/meminfo | grep MemAvailable: | grep -o '[0-9]*')/$(cat /proc/meminfo | grep MemTotal: | grep -o '[0-9]*')*100  | bc) | CPU: #(echo 'scale=3;' '100-' $(cat /proc/stat | head -1 |  sed 's/cpu[ ]*//' | cut -f4 -d' ')/$(cat /proc/stat  | head -1 | sed 's/cpu[ ]*//' | sed 's/ /+/g'| bc)*100 | bc) | CPU: #(. /tmp/test.bash)"

# Left status
set -g status-left ' [#S] '
set -g status-left-fg colour232
set -g status-left-bg colour208
set -g status-left-attr bold

# Status Window
#setw -g window-status-current-style bg=blue,fg=white,bold
setw -g window-status-current-format ' #I:#W#F '
setw -g window-status-current-attr bold
setw -g window-status-current-bg colour45
setw -g window-status-current-fg colour232

setw -g window-status-format ' #I:#W#F '
setw -g window-status-fg colour232
setw -g window-status-attr none

######################## Panes ########################
set -g pane-border-fg colour8
set -g pane-active-border-fg colour12
set -g pane-border-status top
#set -g pane-border-format " #{pane_index} | PPID:#{pane_pid} | CMD:#(ps --no-headers --ppid #{pane_pid} -o pid) | CMD:#(ps --no-headers --ppid #{pane_pid} -o command) | CPU:#(ps --no-headers --ppid #{pane_pid} -o %cpu) | Mem:#(ps --no-headers --ppid #{pane_pid} -o %mem) "
set -g pane-border-format " #{pane_index} | PPID:#{pane_pid} #(#{process_info} #{pane_pid})"

######################## Copy Mode ########################
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle

######################## Colors ########################
# Print this on bash to feel how colors look
# for i in {0..255}; do
#	printf "\x1b[38;5;${i}mcolour${i}\x1b[0m\n"
# done

######################## Plugins ########################
run-shell "~/.tmux/plugins/load_plugins.tmux"
